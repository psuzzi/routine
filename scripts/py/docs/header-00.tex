\usepackage{xcolor}
\usepackage{listings}
\usepackage{fontspec}
\usepackage{titlesec}
\usepackage{enumitem}
\usepackage{fancyhdr}

% Define colors
\definecolor{light-gray}{RGB}{245,245,245}
\definecolor{dark-gray}{RGB}{64,64,64}

% Set up listings for syntax highlighting
\lstset{
    basicstyle=\ttfamily\small,
    backgroundcolor=\color{light-gray},
    breaklines=true,
    breakatwhitespace=true,
    columns=flexible,
    keepspaces=true,
    showstringspaces=false,
    showtabs=false,
    tabsize=2,
    frame=single,
    framerule=0.5pt,
    rulecolor=\color{dark-gray},
    xleftmargin=0pt,
    xrightmargin=0pt,
    aboveskip=\baselineskip,
    belowskip=\baselineskip,
    numbers=left,
    numberstyle=\tiny\color{dark-gray},
    numbersep=5pt,
    keywordstyle=\color{blue}\bfseries,
    commentstyle=\color{green!60!black}\itshape,
    stringstyle=\color{purple},
}

% Adjust section styling
\titleformat{\section}
  {\normalfont\Large\bfseries}{\thesection}{1em}{}
\titleformat{\subsection}
  {\normalfont\large\bfseries}{\thesubsection}{1em}{}

% Adjust list styling
\setlist[enumerate]{leftmargin=*,align=left,widest=99}

% Setup page headers
\pagestyle{fancy}
\fancyhf{}
\renewcommand{\headrulewidth}{0.4pt}
\fancyhead[R]{\thepage}

% Define the Shaded environment for code blocks
\newenvironment{Shaded}
  {\vspace{\baselineskip}\noindent\begin{minipage}{\linewidth}}
  {\end{minipage}\vspace{\baselineskip}}

% Set default fonts
\setmainfont{Times New Roman}
\setmonofont{Courier New}